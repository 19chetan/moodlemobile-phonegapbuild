webpackJsonp([38],{1827:function(l,e,n){"use strict";function t(l){return i._57(0,[(l()(),i._31(0,0,null,null,25,"ion-item",[["class","item item-block"]],[[2,"core-primary-item",null]],null,null,w.b,w.a)),i._30(1,1097728,null,3,I.a,[N.a,T.a,i.t,i.V,[2,$.a]],null,null),i._52(335544320,1,{contentLabel:0}),i._52(603979776,2,{_buttons:1}),i._52(603979776,3,{_icons:1}),i._30(5,16384,null,0,C.a,[],null,null),(l()(),i._55(-1,2,["\n            "])),(l()(),i._31(7,0,null,2,2,"h2",[],null,null,null,null,null)),(l()(),i._31(8,0,null,null,1,"core-format-text",[],null,null,null,null,null)),i._30(9,540672,null,0,E.a,[i.t,c.a,f.a,_.a,M.a,A.a,z.a,G.a,J.a,s.a,K.a,q.a,[2,B.a],[2,H.a]],{text:[0,"text"]},null),(l()(),i._55(-1,2,["\n            "])),(l()(),i._31(11,0,null,2,1,"p",[],null,null,null,null,null)),(l()(),i._55(12,null,["",""])),(l()(),i._55(-1,2,["\n            "])),(l()(),i._31(14,0,null,4,2,"p",[["item-end",""]],null,null,null,null,null)),(l()(),i._55(15,null,["",""])),i._49(16,1),(l()(),i._55(-1,2,["\n            "])),(l()(),i._31(18,0,null,4,6,"button",[["clear",""],["color","danger"],["icon-only",""],["ion-button",""],["item-end",""]],[[8,"hidden",0],[1,"aria-label",0]],[[null,"click"]],function(l,e,n){var t=!0;if("click"===e){t=!1!==l.component.deleteSiteFiles(l.context.$implicit)&&t}return t},Q.b,Q.a)),i._30(19,1097728,[[2,4]],0,W.a,[[8,""],T.a,i.t,i.V],{color:[0,"color"],clear:[1,"clear"]},null),i._47(131072,X.a,[M.a,i.j]),(l()(),i._55(-1,0,["\n                "])),(l()(),i._31(22,0,null,0,1,"ion-icon",[["name","trash"],["role","img"]],[[2,"hide",null]],null,null,null,null)),i._30(23,147456,null,0,Y.a,[T.a,i.t,i.V],{name:[0,"name"]},null),(l()(),i._55(-1,0,["\n            "])),(l()(),i._55(-1,2,["\n        "]))],function(l,e){l(e,9,0,e.context.$implicit.siteName);l(e,19,0,"danger","");l(e,23,0,"trash")},function(l,e){l(e,0,0,e.context.$implicit.id==e.component.currentSiteId);l(e,12,0,e.context.$implicit.fullName);l(e,15,0,i._56(e,15,0,l(e,16,0,i._44(e.parent,0),e.context.$implicit.spaceUsage)));l(e,18,0,!e.context.$implicit.spaceUsage>"0",i._56(e,18,1,i._44(e,20).transform("core.settings.deletesitefilestitle")));l(e,22,0,i._44(e,23)._hidden)})}function a(l){return i._57(0,[i._47(0,Z.a,[J.a,_.a]),(l()(),i._31(1,0,null,null,11,"ion-header",[],null,null,null,null,null)),i._30(2,16384,null,0,ll.a,[T.a,i.t,i.V,[2,el.a]],null,null),(l()(),i._55(-1,null,["\n    "])),(l()(),i._31(4,0,null,null,7,"ion-navbar",[["class","toolbar"]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,nl.b,nl.a)),i._30(5,49152,null,0,tl.a,[al.a,[2,el.a],[2,B.a],T.a,i.t,i.V],null,null),(l()(),i._55(-1,3,["\n        "])),(l()(),i._31(7,0,null,3,3,"ion-title",[],null,null,null,il.b,il.a)),i._30(8,49152,null,0,ul.a,[T.a,i.t,i.V,[2,ol.a],[2,tl.a]],null,null),(l()(),i._55(9,0,["",""])),i._47(131072,X.a,[M.a,i.j]),(l()(),i._55(-1,3,["\n    "])),(l()(),i._55(-1,null,["\n"])),(l()(),i._55(-1,null,["\n"])),(l()(),i._31(14,0,null,null,49,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,rl.b,rl.a)),i._30(15,4374528,null,0,H.a,[T.a,A.a,sl.a,i.t,i.V,al.a,cl.a,i.M,[2,el.a],[2,B.a]],null,null),(l()(),i._55(-1,1,["\n    "])),(l()(),i._31(17,0,null,2,6,"ion-refresher",[],[[2,"refresher-active",null],[4,"top",null]],[[null,"ionRefresh"]],function(l,e,n){var t=!0;if("ionRefresh"===e){t=!1!==l.component.refreshData(n)&&t}return t},null,null)),i._30(18,212992,null,0,_l.a,[A.a,H.a,i.M,fl.l],{enabled:[0,"enabled"]},{ionRefresh:"ionRefresh"}),(l()(),i._55(-1,null,["\n        "])),(l()(),i._31(20,0,null,null,2,"ion-refresher-content",[],[[1,"state",0]],null,null,dl.b,dl.a)),i._30(21,114688,null,0,pl.a,[_l.a,T.a],{pullingText:[0,"pullingText"]},null),i._47(131072,X.a,[M.a,i.j]),(l()(),i._55(-1,null,["\n    "])),(l()(),i._55(-1,1,["\n    "])),(l()(),i._31(25,0,null,1,37,"core-loading",[],null,null,null,hl.b,hl.a)),i._30(26,638976,null,0,gl.a,[M.a,i.t],{hideUntil:[0,"hideUntil"]},null),(l()(),i._55(-1,0,["\n        "])),(l()(),i._26(16777216,null,0,1,null,t)),i._30(29,802816,null,0,ml.j,[i._11,i._6,i.E],{ngForOf:[0,"ngForOf"]},null),(l()(),i._55(-1,0,["\n        "])),(l()(),i._31(31,0,null,0,14,"ion-item-divider",[["class","item item-divider"],["color","light"]],null,null,null,w.b,w.a)),i._30(32,1097728,null,3,I.a,[N.a,T.a,i.t,i.V,[2,$.a]],{color:[0,"color"]},null),i._52(335544320,4,{contentLabel:0}),i._52(603979776,5,{_buttons:1}),i._52(603979776,6,{_icons:1}),i._30(36,16384,null,0,bl.a,[T.a,i.t,i.V],{color:[0,"color"]},null),(l()(),i._55(-1,2,["\n            "])),(l()(),i._31(38,0,null,2,2,"p",[],null,null,null,null,null)),(l()(),i._55(39,null,["",""])),i._47(131072,X.a,[M.a,i.j]),(l()(),i._55(-1,2,["\n            "])),(l()(),i._31(42,0,null,4,2,"p",[["item-end",""]],null,null,null,null,null)),(l()(),i._55(43,null,["",""])),i._49(44,1),(l()(),i._55(-1,2,["\n        "])),(l()(),i._55(-1,0,["\n        "])),(l()(),i._31(47,0,null,0,14,"ion-item-divider",[["class","item item-divider"],["color","light"]],null,null,null,w.b,w.a)),i._30(48,1097728,null,3,I.a,[N.a,T.a,i.t,i.V,[2,$.a]],{color:[0,"color"]},null),i._52(335544320,7,{contentLabel:0}),i._52(603979776,8,{_buttons:1}),i._52(603979776,9,{_icons:1}),i._30(52,16384,null,0,bl.a,[T.a,i.t,i.V],{color:[0,"color"]},null),(l()(),i._55(-1,2,["\n            "])),(l()(),i._31(54,0,null,2,2,"p",[],null,null,null,null,null)),(l()(),i._55(55,null,["",""])),i._47(131072,X.a,[M.a,i.j]),(l()(),i._55(-1,2,["\n            "])),(l()(),i._31(58,0,null,4,2,"p",[["item-end",""]],null,null,null,null,null)),(l()(),i._55(59,null,["",""])),i._49(60,1),(l()(),i._55(-1,2,["\n        "])),(l()(),i._55(-1,0,["\n    "])),(l()(),i._55(-1,1,["\n"])),(l()(),i._55(-1,null,["\n"]))],function(l,e){var n=e.component;l(e,18,0,n.usageLoaded);l(e,21,0,i._34(1,"",i._56(e,21,0,i._44(e,22).transform("core.pulltorefresh")),""));l(e,26,0,n.usageLoaded);l(e,29,0,n.sites);l(e,32,0,"light");l(e,36,0,"light");l(e,48,0,"light");l(e,52,0,"light")},function(l,e){var n=e.component;l(e,4,0,i._44(e,5)._hidden,i._44(e,5)._sbPadding);l(e,9,0,i._56(e,9,0,i._44(e,10).transform("core.settings.spaceusage")));l(e,14,0,i._44(e,15).statusbarPadding,i._44(e,15)._hasRefresher);l(e,17,0,"inactive"!==i._44(e,18).state,i._44(e,18)._top);l(e,20,0,i._44(e,21).r.state);l(e,39,0,i._56(e,39,0,i._44(e,40).transform("core.settings.total")));l(e,43,0,i._56(e,43,0,l(e,44,0,i._44(e,0),n.totalUsage)));l(e,55,0,i._56(e,55,0,i._44(e,56).transform("core.settings.estimatedfreespace")));l(e,59,0,i._56(e,59,0,l(e,60,0,i._44(e,0),n.freeSpace)))})}Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),u=n(9),o=n(7),r=n(42),s=n(16),c=n(1),_=n(10),f=n(6),d=this&&this.__decorate||function(l,e,n,t){var a,i=arguments.length,u=i<3?e:null===t?t=Object.getOwnPropertyDescriptor(e,n):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(l,e,n,t);else for(var o=l.length-1;o>=0;o--)(a=l[o])&&(u=(i<3?a(u):i>3?a(e,n,u):a(e,n))||u);return i>3&&u&&Object.defineProperty(e,n,u),u},p=this&&this.__metadata||function(l,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(l,e)},h=function(){function l(l,e,n,t,a,i){this.fileProvider=l,this.filePoolProvider=e,this.sitesProvider=n,this.textUtils=t,this.translate=a,this.domUtils=i,this.usageLoaded=!1,this.sites=[],this.currentSiteId="",this.totalUsage=0,this.freeSpace=0,this.currentSiteId=this.sitesProvider.getCurrentSiteId()}return l.prototype.ionViewDidLoad=function(){var l=this;this.fetchData().finally(function(){l.usageLoaded=!0})},l.prototype.calculateSizeUsage=function(){var l=this;return this.sitesProvider.getSortedSites().then(function(e){l.sites=e;var n=l.sites.map(function(e){return l.sitesProvider.getSite(e.id).then(function(l){return l.getSpaceUsage().then(function(l){e.spaceUsage=l})})});return Promise.all(n)})},l.prototype.calculateTotalUsage=function(){var l=0;this.sites.forEach(function(e){e.spaceUsage&&(l+=parseInt(e.spaceUsage,10))}),this.totalUsage=l},l.prototype.calculateFreeSpace=function(){var l=this;return this.fileProvider.isAvailable()?this.fileProvider.calculateFreeSpace().then(function(e){l.freeSpace=e}).catch(function(){l.freeSpace=0}):(this.freeSpace=0,Promise.resolve(null))},l.prototype.fetchData=function(){var l=this;return Promise.all([this.calculateSizeUsage().then(function(){return l.calculateTotalUsage()}),this.calculateFreeSpace()])},l.prototype.refreshData=function(l){this.fetchData().finally(function(){l.complete()})},l.prototype.updateSiteUsage=function(l,e){var n=l.spaceUsage;l.spaceUsage=e,this.totalUsage-=n-e,this.freeSpace+=n-e},l.prototype.deleteSiteFiles=function(l){var e=this;this.textUtils.formatText(l.siteName).then(function(n){var t=e.translate.instant("core.settings.deletesitefilestitle"),a=e.translate.instant("core.settings.deletesitefiles",{sitename:n});e.domUtils.showConfirm(a,t).then(function(){return e.sitesProvider.getSite(l.id)}).then(function(n){n.deleteFolder().then(function(){e.filePoolProvider.clearAllPackagesStatus(n.id),e.filePoolProvider.clearFilepool(n.id),e.updateSiteUsage(l,0)}).catch(function(t){t&&t.code===FileError.NOT_FOUND_ERR?(e.filePoolProvider.clearAllPackagesStatus(n.id),e.updateSiteUsage(l,0)):(e.domUtils.showErrorModal("core.settings.errordeletesitefiles",!0),n.getSpaceUsage().then(function(n){e.updateSiteUsage(l,n)}))})}).catch(function(){})})},l=d([Object(i.m)({selector:"page-core-settings-space-usage",templateUrl:"space-usage.html"}),p("design:paramtypes",[r.a,s.a,c.a,_.a,o.c,f.a])],l)}(),g=n(31),m=n(30),b=n(111),v=this&&this.__decorate||function(l,e,n,t){var a,i=arguments.length,u=i<3?e:null===t?t=Object.getOwnPropertyDescriptor(e,n):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(l,e,n,t);else for(var o=l.length-1;o>=0;o--)(a=l[o])&&(u=(i<3?a(u):i>3?a(e,n,u):a(e,n))||u);return i>3&&u&&Object.defineProperty(e,n,u),u},S=function(){function l(){}return l=v([Object(i.I)({declarations:[h],imports:[g.a,m.a,b.a,u.l.forChild(h),o.b.forChild()]})],l)}(),U=n(1243),P=n(1244),y=n(1245),j=n(1246),x=n(1247),R=n(1248),O=n(1249),F=n(1250),V=n(1251),D=n(1254),L=n(1255),k=n(1256),w=n(33),I=n(19),N=n(18),T=n(3),$=n(29),C=n(32),E=n(39),M=n(15),A=n(13),z=n(4),G=n(23),J=n(2),K=n(12),q=n(22),B=n(20),H=n(24),Q=n(43),W=n(37),X=n(28),Y=n(38),Z=n(1321),ll=n(402),el=n(34),nl=n(1252),tl=n(182),al=n(27),il=n(1253),ul=n(315),ol=n(227),rl=n(183),sl=n(25),cl=n(93),_l=n(139),fl=n(35),dl=n(203),pl=n(150),hl=n(57),gl=n(55),ml=n(8),bl=n(184),vl=i._29({encapsulation:2,styles:[],data:{}}),Sl=i._27("page-core-settings-space-usage",h,function(l){return i._57(0,[(l()(),i._31(0,0,null,null,1,"page-core-settings-space-usage",[],null,null,null,a,vl)),i._30(1,49152,null,0,h,[r.a,s.a,c.a,_.a,M.a,f.a],null,null)],null,null)},{},{},[]),Ul=n(17),Pl=n(311),yl=n(312),jl=n(314),xl=n(313),Rl=n(401),Ol=n(615),Fl=n(228);n.d(e,"CoreSettingsSpaceUsagePageModuleNgFactory",function(){return Vl});var Vl=i._28(S,[],function(l){return i._40([i._41(512,i.o,i._21,[[8,[U.a,P.a,y.a,j.a,x.a,R.a,O.a,F.a,V.a,D.a,L.a,k.a,Sl]],[3,i.o],i.K]),i._41(4608,ml.m,ml.l,[i.G,[2,ml.v]]),i._41(4608,Ul.x,Ul.x,[]),i._41(4608,Ul.d,Ul.d,[]),i._41(4608,Pl.b,Pl.a,[]),i._41(4608,yl.a,yl.b,[]),i._41(4608,jl.b,jl.a,[]),i._41(4608,xl.b,xl.a,[]),i._41(4608,M.a,M.a,[Rl.a,Pl.b,yl.a,jl.b,xl.b,M.b,M.c]),i._41(512,ml.b,ml.b,[]),i._41(512,Ul.v,Ul.v,[]),i._41(512,Ul.i,Ul.i,[]),i._41(512,Ul.s,Ul.s,[]),i._41(512,Ol.a,Ol.a,[]),i._41(512,o.b,o.b,[]),i._41(512,m.a,m.a,[]),i._41(512,b.a,b.a,[]),i._41(512,g.a,g.a,[]),i._41(512,Ol.b,Ol.b,[]),i._41(512,S,S,[]),i._41(256,M.c,void 0,[]),i._41(256,M.b,void 0,[]),i._41(256,Fl.a,h,[])])})}});